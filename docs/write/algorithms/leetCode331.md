---
title: 331.验证二叉树的前序序列化
author: Younglina
date: '2022-07-22'
showAccessNumber: true
categories:
 - 算法
tags:
 - 刷题
 - 树
 - 中等
---
## 题目描述
[331.验证二叉树的前序序列化](https://leetcode-cn.com/problems/remove-element/)  
序列化二叉树的一种方法是使用 前序遍历 。当我们遇到一个非空节点时，我们可以记录下这个节点的值。如果它是一个空节点，我们可以使用一个标记值记录，例如 #。  
          9  
         / \  
        3   2  
       / \   \  
      4   1   6  
例如，上面的二叉树可以被序列化为字符串 "9,3,4,#,#,1,#,#,2,#,6,#,#"，其中 # 代表一个空节点。  

给定一串以逗号分隔的序列，验证它是否是正确的二叉树的前序序列化。编写一个在不重构树的条件下的可行算法。  

保证 每个以逗号分隔的字符或为一个整数或为一个表示 null 指针的 '#' 。  

你可以认为输入格式总是有效的  

例如它永远不会包含两个连续的逗号，比如 "1,,3" 。  
注意：不允许重建树。  

### 示例 1：
```
输入: preorder = "9,3,4,#,#,1,#,#,2,#,6,#,#"
输出: true
```

### 示例 2：
```
输入: preorder = "1,#"  
输出: false  
```

### 示例 3：
```
输入: preorder = "9,#,#,1"  
输出: false  
```

:::tip 提示
1 <= preorder.length <= 104  
preorder 由以逗号 “，” 分隔的 [0,100] 范围内的整数和 “#” 组成  
:::

## 思路
叶子节点会紧跟两个`#`，如果一个节点左节点是一个有效的节点，右节点是个空节点即`#`时，可以将有效节点替换成`#`，那么当前节点也就变成了紧跟两个`#`的有效节点  

即遇到`n,#,#`时，把它变成`#`，用栈模拟遍历  

```
如 "9,3,4,#,#,1,#,#,2,#,6,#,#"  
1. 当遍历到 "9,3,4,#,#" 时，变为 "9,3,#"
2. 当遍历到 "9,3,#,1,#,#" 时，变为 "9,3,#,#" 再变  "9,#"
3. "9,#,2,#,6,#,#" -> "9,#,2,#,#" -> "9,#,#" -> "#"

最后判断长度是不是1，并且是`#`
```

## 题解
```javascript
var isValidSerialization = function(preorder) {
    let stack = []
    for(let node of preorder.split(',')){
        stack.push(node)
        while(stack.length>=3 && stack.at(-1)==='#' && stack.at(-2)==='#' && stack.at(-3)!=='#'){
            stack.length-=3
            stack.push('#')
        }
    }
    return stack.length===1 && stack.pop()==='#'
};
```